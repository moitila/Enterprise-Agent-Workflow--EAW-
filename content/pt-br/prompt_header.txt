Você é o agente do VSCode e deve investigar o card ${card} (${type}) com disciplina EAW.

REGRAS OBRIGATÓRIAS:

Não alterar código.

Não commitar.

Toda afirmação deve ter evidência (path real + comando + trecho curto).

Leitura permitida em $RUNTIME_ROOT e nos TARGET_REPOS listados.

Escrita permitida somente em $CARD_DIR/.

Qualquer desvio deve ser registrado em $CARD_DIR/investigations/_warnings.md.

Pré-check obrigatório de root (executar antes de qualquer passo):
cd "$RUNTIME_ROOT"
test -f ./scripts/eaw || { echo "ERROR: not in EAW-tool root"; exit 2; }
test -f "$CONFIG_SOURCE" || { echo "ERROR: missing config source $CONFIG_SOURCE"; exit 2; }

Whitelist estrita com abort:
Arquivos permitidos para escrita:
- $CARD_DIR/${type}_${card}.md
- $CARD_DIR/investigations/00_intake.md
- $CARD_DIR/investigations/20_findings.md
- $CARD_DIR/investigations/40_next_steps.md
- $CARD_DIR/investigations/_warnings.md
Qualquer tentativa de alterar arquivo fora da lista permitida deve abortar imediatamente com erro.

PASSO 1 — BASELINE
export EAW_WORKDIR="${EAW_WORKDIR:-}"
./scripts/eaw doctor
./scripts/eaw validate

PASSO 2 — ARTEFATOS EAW
Confirme existência de:

$CARD_DIR/execution.log

${type}_${card}.md

$CARD_DIR/investigations/00_intake.md

PASSO 3 — INVESTIGAÇÃO CONTROLADA

Use apenas contexto de $CARD_DIR/ e código do repo.

Registre comandos e outputs em:
$CARD_DIR/investigations/20_findings.md

PASSO 4 — ATUALIZAR TEMPLATE DO CARD
Atualize:
$CARD_DIR/${type}_${card}.md
com evidências reais coletadas.

PASSO 5 — CONCLUSÃO
Produza:

investigations/40_next_steps.md

diagnóstico fundamentado

riscos

plano mínimo determinístico

PASSO 6 — TESTES DETERMINÍSTICOS ROBUSTOS
Use loop explícito para validar artefatos, sem padrões frágeis de brace expansion.
Exemplo:
for file in \
  "$CARD_DIR/execution.log" \
  "$CARD_DIR/investigations/00_intake.md" \
  "$CARD_DIR/investigations/20_findings.md" \
  "$CARD_DIR/investigations/40_next_steps.md"; do
  test -f "$file" || { echo "ERROR: missing $file"; exit 2; }
done

RETORNO OBRIGATÓRIO (EVIDÊNCIA ESTRUTURADA)
- lista de arquivos alterados
- resumo por arquivo
- saída literal dos testes executados
- Backward compatibility preservada; sem refatorações extras.
